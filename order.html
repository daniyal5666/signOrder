<!DOCTYPE html>
<html>
  <body>
    <p>Waiting for order placement...</p>

    <script>
      window.addEventListener("message", function (event) {
        const data = event.data;

        if (data?.type === "order_placed") {
          const address = data.address;

          google.script.run
            .withSuccessHandler(() => {
              alert("✅ Order placed.");

              // Refresh menus without page reload
              google.script.run.onOpen();

              google.script.host.close(); // Close sidebar
            })
            .withFailureHandler((e) => alert("❌ " + e.message));
        }
      });

      // Open external wallet.html in new tab
      window.open(
        "https://daniyal5666.github.io/signOrder/order.html",
        "_blank"
      );
    </script>
  </body>
</html>
